---
layout: post 
category: papers 
---

### cache.h

RocksDB提供了一个可选的高低优先级LRU策略。可以通过 cache.h中的double 类型变量high_pri_pool_ratio的值（0到1之间）调整为高优先级条目保留的缓存百分比。

如果大于零，LRU 列表将被拆分为高优先级列表和低优先级列表。高优先级条目将插入到高优先级列表的尾部，而低优先级条目将首先插入低优先级列表（中点）。这被称为中点插入策略，可以使缓存中从未命中的条目更快地被替换出去。



```c++
std::shared_ptr<MemoryAllocator> memory_allocator;
```

提供了自定义的内存分配接口

rocksDB允许构建一个二级cache，存储在非易失性的存储介质中（一般是flash）

rocksDB允许多线程并发访问cache通过自旋锁(自适应互斥锁)控制。

自旋锁：与互斥量类似，它不是通过休眠使进程阻塞，而是在获取锁之前一直处于忙等(自旋)阻塞状态。用在以下情况：锁持有的时间短，而且线程并不希望在重新调度上花太多的成本。"原地打转"。
